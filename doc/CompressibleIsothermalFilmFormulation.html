<html>
<head>
  <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
</head>
<body>
<h1>Compressible Isothermal Thin Film Formulation</h1>
  <p>
    The compressible Reynolds equation: 
    $$ \begin{equation} \label{eq:1} 12 \mu \frac \partial {\partial t} (ph) + 6 \mu \nabla \centerdot(ph\vec V) - \nabla \centerdot (h^3 p\nabla p) = 0 \end{equation}$$
  </p>
  <p>\(\mu\) is the fluid dynamic viscosity<br>
     \(p\) is the pressure field defined on the 2 dimensional lubrication film domain<br>
     \(h\) is the film thickness, which may vary over the domain<br>
     \(\vec V\) is the relative velocity of the upper and lower bearing surfaces
  </p>
  <p>

    The weak form of equation \eqref{eq:1} is:
    $$ \begin{equation} \label{eq:2} (\psi , 12 \mu \frac \partial {\partial t} (ph)) 
      + (\psi,6 \mu \nabla \centerdot(ph\vec V)) 
      - (\psi,\nabla \centerdot (h^3 p\nabla p)) 
      = 0 \end{equation}$$

    <a href = "http://mooseframework.org/wiki/MooseTraining/FEM/Principles/">The divergence theorem (scroll to 'Refresher: The divergence theorem')</a> is applied on the second and third terms of the left hand side of equation \eqref{eq:2}
   
    
    $$ \begin{equation} \label{eq:3} 
      \left(\psi, 12 \mu h \frac {\partial p} {\partial t} \right)
      +\left(\psi, 12 \mu p \frac {\partial h} {\partial t} \right)
      -\left(\nabla \psi, 6\mu h p \vec V\right) +\left\langle\psi,6\mu hp\vec V \centerdot \hat n \right\rangle
      +\left(\nabla \psi , h^3 p \nabla p\right) -\left\langle \psi, h^3 p \nabla p \centerdot \hat n \right\rangle
      = 0 \end{equation}$$

    Each of the terms in equation \eqref{eq:3} are implemented as kernels:<br>
    <ul>
    <li>\(\left(\psi , 12 \mu h \frac {\partial p} {\partial t} \right) \to\)
      CompressibleIsothermalPTimeDerivative (not currently implemented) 
    </li>
    <li>\(\left(\psi , 12 \mu p \frac {\partial h} {\partial t} \right) \to\)
      CompressibleIsothermalHTimeDerivative (not currently implemented)
    </li>
    <li>\(-\left(\nabla \psi, 6\mu h p \vec V\right) \to\) CompressibleIsothermalShearFlow</li>
    <li>\(\left\langle\psi,6\mu hp\vec V \centerdot \hat n \right\rangle \to\) CompressibleIsothermalShearFlowDG</li>
    <li>\(\left(\nabla \psi , h^3 p \nabla p\right) \to\) CompressibleIsothermalPressureFlow</li>
    <li>\(-\left\langle \psi, h^3 p \nabla p \centerdot \hat n \right\rangle \to \) CompressibleIsothermalPressureFlowDG</li>
    </ul>
  </p>
  <h2>CompressibleIsothermalTimeDerivative</h2>
  <p>Not currently implemented</p>
  <h2>CompressibleIsothermalShearFlow</h2>
  <p>
    $$ \begin{equation} \label{eq:4}
    R_i(p_h) = -\left(\nabla \psi_i, 6\mu h p_h \vec V\right)
    \end{equation}$$

    $$ \begin{equation} \label{eq:5}
    J_{ij}(p_h) = -\left(\nabla \psi_i, 6\mu h \phi_j \vec V\right)
    \end{equation}$$

  </p>
  <h2>CompressibleIsothermalShearFlowDG</h2>
  <p>
    The term this dgkernel is responsible for computing <br>
    \(\left\langle\psi,6\mu hp\vec V \centerdot \hat n \right\rangle = \left\langle \psi,f^* \right\rangle  \) <br>
    This term is a surface term.  At the boundary seperating two elements, the values on the nodes are defined for both elements.
    Some decision must be made to construct a single flux, \(f^*\), which will link the two elements.  In this implementation, 
    \(f^*\) is chosen to be the upwind flux.
    <br>
    If \( \vec V \centerdot \hat n_{elem} \ge 0 \):
    $$ \begin{equation} \label{eq:6}
    f_{elem}^* = -f_{neighbor}^* = 6 \mu h p_{elem} \vec V \centerdot \hat n_{elem}
    \end{equation}$$

    $$ \begin{equation} \label{eq:7}
    R_{elem,i} = -R_{neighbor,i} =\left\langle \psi, 6 \mu h p_{elem} \vec V \centerdot \hat n_{elem} \right\rangle
    \end{equation}$$
    
    $$ \begin{equation} \label{eq:8}
    \frac {\partial R_{elem,i}} {\partial p_{elem}} = 
    -\frac {\partial R_{neighbor,i}} {\partial p_{elem}} = 
    6.0 \mu h \phi_{elem} \vec V \centerdot \hat n_{elem}
    \end{equation}$$

    $$ \begin{equation} \label{eq:9}
    \frac {\partial R_{elem,i}} {\partial p_{neighbor}} =
    \frac {\partial R_{neighbor,i}} {\partial p_{neighbor}} = 0
    \end{equation}$$

    Else:
    $$ \begin{equation} \label{eq:10}
    f_{elem}^* = -f_{neighbor}^* = 6 \mu h p_{neighbor} \vec V \centerdot \hat n_{elem}
    \end{equation}$$

    $$ \begin{equation} \label{eq:11}
    R_{elem,i} = -R_{neighbor,i} =
    \left\langle \psi, 6 \mu h p_{neighbor} \vec V \centerdot \hat n_{elem} \right\rangle
    \end{equation}$$
    
    $$ \begin{equation} \label{eq:12}
    \frac {\partial R_{elem,i}} {\partial p_{elem}} =
    \frac {\partial R_{neighbor,i}} {\partial p_{elem}} = 0
    \end{equation}$$

    $$ \begin{equation} \label{eq:13}
    \frac {\partial R_{elem,i}} {\partial p_{neighbor}} = 
    -\frac {\partial R_{neighbor,i}} {\partial p_{neighbor}} = 
    6.0 \mu h \phi_{neighbor} \vec V \centerdot \hat n_{elem}
    \end{equation}$$

  </p>
  <h2>CompressibleIsothermalPressureFlow</h2>
  <p>
    This Kernel computes \(\left(\nabla \psi, h^3 p \nabla p \right)\).
  </p>
  <h2>CompressibleIsothermalPressureFlowDG</h2>
  <p>
    This DGKernel computes \(-\left\langle \psi, h^3 p \nabla p \centerdot \hat n \right\rangle\)
  </p>
</body>
</html>
